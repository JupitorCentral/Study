

## Network


### Questions

#### 클라이언트와 서버의 역할은 ?

클라이언트는 데이터를 요청하는 역할, 서버는 클라이언트의 요청을 처리하고 그 결과를 클라이언트에게 돌려주는 역할.

HTTP 웹서버와 같은 서버 프로그램은 다음과 같은 루프를 계속 반복함.
-> incoming data stream 을 통해 클라이언트로부터 명령을 받음
-> 클라이언트 명령어를 decode
-> 클라이언트가 요청한 정보를 한데 모음
-> outgoing stream data 를 통해 클라이언트가 요청한 정보를 반환


#### 네트워크 프로그래밍이란 무엇이며 왜 필요한가

네트워크 프로그래밍이란, 네트워크를 통해 다른 컴퓨터와 연결하여 데이터를 주고 받도록 만든 기술.
이것이 필요한 이유는, 웹 페이지 요청, 서버-클라이언트 통신, 이메일 전송 등 분산 시스템의 
거의 모든 기능이 네트워크 위에서 이루어지기 때문.


#### UDP 가 필요한 경우

TCP - 연결 지향, 순서 보장, 신뢰성.
UDP 는 연결없이 빠르고, 가벼우나 순서/손실 보상 없음.
오디오/비디오 스트리밍 처럼 일부 손실 허용 상황에 적합.


#### 클라이언트와 서버가 통신하려면 반드시 알아야 하는 두 요소.

아이피, 포트

#### TCP / IP 계층 4계층 구조

1. Application Layer
HTTP, SMTP, FTP 등 사용자 어플리케이션이 동작하는 계층

2. Transport Layer
TCP, UDP 등이 동작하는 계층

3. Internet Layer
IP 프로토콜이 동작하는 계층

4. Network Access Layer
물리적 네트워크를 담당하는 계층


#### Java 에서 Socket 이란 도대체 무엇인가 ?

보통 서버는 어떤 특정 컴퓨터에서 실행되고, 어떤 포트에 묶어있는 socket 이라는게 있다.
서버는 단지 클라이언트가 연결 요청을 할때까지 socket 을 listtening 한다.

클라이언트 쪽에서는 서버가 돌아가고 있는 기계의 호스트네임과 서버가 listenning 하고 있는 포트번호를 알고 있다.

To make a connection request, the client tries to rendezvous with the server on the server's machine and port. 
-> 연결을 요청하기ㅏ 위해, 클라이언트는 서버의 머신과 포트를 이용해 서버와 랑데뷰하려고 함

The client also needs to identify itself to the server so it binds to a local port number that it will use during this connection. 
-> 클라이언트는 또한 스스로를 서버에 indentify (구분, 클라이언트 스스로를 명확히 밝히는 것) 해서,  
연결할 동안 쓸 local port number (클라이언트 측에서 로컬임) 를 bind 해야 함.

This is usually assigned by the system.
-> 이건 주로 시스템이 한다

A _socket_ is one endpoint of a two-way communication link between two programs running on the network. 
-> 소켓은 네트워크위에서 돌아가는 두 프로그램 사이의 two-way communication 링크 의 endpoint 이다.
(two-way - 서로 받고 보낼 수 있는 방식)

A socket is bound to a port number so that the TCP layer can identify the application that data is destined to be sent to.
-> 소켓은 port number 에 묶이게 되는데 그래서 TCP layer 가 보내지기로 한 어플리케이션이 무엇인지 알아채릴 수 있게 된다.

An endpoint is a combination of an IP address and a port number.
-> 엔드포인트는 IP 주소와 포트넘버의 조합


#### TCP / IP 계층 구조에서 Socket 은 어느 위치에 있는가 ?

Socket은 계층구조가 아니라, Application layer 와 Transport Layer 를 이어주는 API 이다.
어플리케이션이 네트워크 기능을 사용하기 위해서 운영체제의 전송계층에 접근하는 소프트웨어 인터페이스.


#### 자바에서 소켓이 없다면, 어떻게 네트워크 통신을 해야 하는가 ?

Socket API 가없다면 , JNI (Java Native Interface) 를 사용해
운영체제의 Native System Call 을 직접 호출해야 함.


#### 자바에서 Socket 의 역할

추상화 계층 : Socket Class 는 운영체제의 TCP/IP 를 자바 객체로 추상화함.
`InputStream`과 `OutputStream`을 통해 네트워크 데이터를 읽고 쓸 수 있게 해줌.

**플랫폼 독립성**: Socket API 덕분에 Windows, Linux, macOS 등 다양한 운영체제에서 동일한 코드로 네트워크 통신이 가능.


##### Socket 없이 통신하는 구체적 예시

```java
Socket s = new Socket("time-a.nist.gov", 13);
InputStream inStream = s.getInputStream();
```

소켓이 없다면...

```java
// JNI로 C 함수 호출
native int nativeSocket();
native int nativeConnect(int fd, String host, int port);
native int nativeRead(int fd, byte[] buffer);
// ... 등등
```




#### 자바에서 Socket을 생성한다는 것은 OS 레벨에서 어떤 일이 일어나는가?

자바에서 `new Socket(host, port)`를 호출하면, OS 레벨에서 다음 과정이 실행됨.

자바에서 Socket 생성 -> JNI 호출 -> OS 의 `socket()` 시스템 콜 -> File Descriptor 생성
-> 커널 메모리에 소켓 구조체 할당 -> TCP / IP 스택에 연결




## Generic

[[250913#^45e137]]



